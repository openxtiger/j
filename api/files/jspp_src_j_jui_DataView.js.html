<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>jspp/src/j/jui/DataView.js - The Js++ Language</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.8.0pr2/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <script src="http://yui.yahooapis.com/combo?3.8.0pr2/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            <h1><a href="../index.html"><img src="../assets/css/logo.png">The Js++ Language: jspp/src/j/jui/DataView.js</a></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 1.0.0</em>
        </div>
    </div>
    <div class="yui3-g">

        <div id="sidebar" class="yui3-u">
            <div id="modules" class="sidebox">
    <div class="hd">
        <h2 class="no-toc">Modules</h2>
    </div>
    <div class="bd">
        <ul>
            
                <li><a href="../modules/DOM_UNIT.html">DOM_UNIT</a>
                
                </li>
            
                <li><a href="../modules/jui.html">jui</a>
                
                </li>
            
                <li><a href="../modules/junit.html">junit</a>
                
                </li>
            
                <li><a href="../modules/OOP.html">OOP</a>
                
                </li>
            
        </ul>
    </div>
</div>

<div id="classes" class="sidebox">
    <div class="hd">
        <h2 class="no-toc">Classes</h2>
    </div>
    <div class="bd">
        <ul>
            
                <li><a href="../classes/dataview.html">dataview</a></li>
            
                <li><a href="../classes/Jclass.html">Jclass</a></li>
            
                <li><a href="../classes/jde.DataProxy.html">jde.DataProxy</a></li>
            
                <li><a href="../classes/jde.JsonReader.html">jde.JsonReader</a></li>
            
                <li><a href="../classes/JDEngine.html">JDEngine</a></li>
            
                <li><a href="../classes/jdengine.html">jdengine</a></li>
            
                <li><a href="../classes/jsonreader.html">jsonreader</a></li>
            
                <li><a href="../classes/jui.Component.html">jui.Component</a></li>
            
                <li><a href="../classes/jui.DataView.html">jui.DataView</a></li>
            
                <li><a href="../classes/jui.form.Checkbox.html">jui.form.Checkbox</a></li>
            
                <li><a href="../classes/jui.form.ComboBox.html">jui.form.ComboBox</a></li>
            
                <li><a href="../classes/jui.form.Field.html">jui.form.Field</a></li>
            
                <li><a href="../classes/jui.form.Hidden.html">jui.form.Hidden</a></li>
            
                <li><a href="../classes/jui.form.NumberFiled.html">jui.form.NumberFiled</a></li>
            
                <li><a href="../classes/jui.form.Radio.html">jui.form.Radio</a></li>
            
                <li><a href="../classes/jui.form.TextArea.html">jui.form.TextArea</a></li>
            
                <li><a href="../classes/jui.form.TextField.html">jui.form.TextField</a></li>
            
                <li><a href="../classes/jui.form.TriggerField.html">jui.form.TriggerField</a></li>
            
                <li><a href="../classes/jui.form.TwinTriggerField.html">jui.form.TwinTriggerField</a></li>
            
                <li><a href="../classes/jui.Layer.html">jui.Layer</a></li>
            
                <li><a href="../classes/junit.BaseTemplate.html">junit.BaseTemplate</a></li>
            
                <li><a href="../classes/junit.JTemplate.html">junit.JTemplate</a></li>
            
                <li><a href="../classes/junit.MixedCollection.html">junit.MixedCollection</a></li>
            
                <li><a href="../classes/junit.Observable.html">junit.Observable</a></li>
            
                <li><a href="../classes/junit.STemplate.html">junit.STemplate</a></li>
            
                <li><a href="../classes/junit.Template.html">junit.Template</a></li>
            
                <li><a href="../classes/Opp.html">Opp</a></li>
            
        </ul>
    </div>
</div>










<div id="fileTree" class="sidebox">
    <div class="hd">
        <h2 class="no-toc">Files</h2>
    </div>
    <div class="bd">
        <ul><li>jspp/<ul><li>src/<ul><li>core/<ul><li><a href="../files/jspp_src_core_j.js.html">j.js</a></li><li><a href="../files/jspp_src_core_oop.js.html">oop.js</a></li></ul></li><li>j/<ul><li>jde/<ul><li><a href="../files/jspp_src_j_jde_DataProxy.js.html">DataProxy.js</a></li><li><a href="../files/jspp_src_j_jde_JDEngine.js.html">JDEngine.js</a></li><li><a href="../files/jspp_src_j_jde_JsonReader.js.html">JsonReader.js</a></li></ul></li><li>jui/<ul><li><a href="../files/jspp_src_j_jui_Component.js.html">Component.js</a></li><li><a href="../files/jspp_src_j_jui_DataView.js.html">DataView.js</a></li><li><a href="../files/jspp_src_j_jui_Layer.js.html">Layer.js</a></li><li>form/<ul><li><a href="../files/jspp_src_j_jui_form_Checkbox.js.html">Checkbox.js</a></li><li><a href="../files/jspp_src_j_jui_form_ComboBox.js.html">ComboBox.js</a></li><li><a href="../files/jspp_src_j_jui_form_Field.js.html">Field.js</a></li><li><a href="../files/jspp_src_j_jui_form_Hidden.js.html">Hidden.js</a></li><li><a href="../files/jspp_src_j_jui_form_NumberField.js.html">NumberField.js</a></li><li><a href="../files/jspp_src_j_jui_form_Radio.js.html">Radio.js</a></li><li><a href="../files/jspp_src_j_jui_form_TextArea.js.html">TextArea.js</a></li><li><a href="../files/jspp_src_j_jui_form_TextField.js.html">TextField.js</a></li><li><a href="../files/jspp_src_j_jui_form_TriggerField.js.html">TriggerField.js</a></li></ul></li></ul></li><li>junit/<ul><li><a href="../files/jspp_src_j_junit_MixedCollection.js.html">MixedCollection.js</a></li><li><a href="../files/jspp_src_j_junit_Observable.js.html">Observable.js</a></li><li><a href="../files/jspp_src_j_junit_Template.js.html">Template.js</a></li><li><a href="../files/jspp_src_j_junit_XTemplate.js.html">XTemplate.js</a></li></ul></li></ul></li></ul></li></ul></li></ul>
    </div>
</div>



        </div>

        <div id="main" class="yui3-u">
            <div class="content"><h4>jspp/src/j/jui/DataView.js</h4>

<pre class="code prettyprint linenums">
/**
 * @pakcage jui
 * @module jui
 */
&#x27;package jui&#x27;.j(function () {

    /**
     * @class jui.DataView
     * @class dataview
     * @extends jui.Component
     */
    &#x27;class DataView extends jui.Component&#x27;.j(function (csuper, cob) {
        jprotected({
            /**
             * @event beforeclick
             * Fires before a click is processed. Returns false to cancel the default action.
             * @param {Ext.DataView} this
             * @param {Number} index The index of the target node
             * @param {HTMLElement} node The target node
             * @param {Ext.EventObject} e The raw event object
             */
            /**
             * @event click
             * Fires when a template node is clicked.
             * @param {Ext.DataView} this
             * @param {Number} index The index of the target node
             * @param {HTMLElement} node The target node
             * @param {Ext.EventObject} e The raw event object
             */
            /**
             * @event mouseenter
             * Fires when the mouse enters a template node. trackOver:true or an overClass must be set to enable this event.
             * @param {Ext.DataView} this
             * @param {Number} index The index of the target node
             * @param {HTMLElement} node The target node
             * @param {Ext.EventObject} e The raw event object
             */
            /**
             * @event mouseleave
             * Fires when the mouse leaves a template node. trackOver:true or an overClass must be set to enable this event.
             * @param {Ext.DataView} this
             * @param {Number} index The index of the target node
             * @param {HTMLElement} node The target node
             * @param {Ext.EventObject} e The raw event object
             */
            /**
             * @event containerclick
             * Fires when a click occurs and it is not on a template node.
             * @param {Ext.DataView} this
             * @param {Ext.EventObject} e The raw event object
             */
            /**
             * @event dblclick
             * Fires when a template node is double clicked.
             * @param {Ext.DataView} this
             * @param {Number} index The index of the target node
             * @param {HTMLElement} node The target node
             * @param {Ext.EventObject} e The raw event object
             */
            /**
             * @event contextmenu
             * Fires when a template node is right clicked.
             * @param {Ext.DataView} this
             * @param {Number} index The index of the target node
             * @param {HTMLElement} node The target node
             * @param {Ext.EventObject} e The raw event object
             */
            /**
             * @event containercontextmenu
             * Fires when a right click occurs that is not on a template node.
             * @param {Ext.DataView} this
             * @param {Ext.EventObject} e The raw event object
             */
            /**
             * @event selectionchange
             * Fires when the selected nodes change.
             * @param {Ext.DataView} this
             * @param {Array} selections Array of the selected nodes
             */

            /**
             * @event beforeselect
             * Fires before a selection is made. If any handlers return false, the selection is cancelled.
             * @param {Ext.DataView} this
             * @param {HTMLElement} node The node to be selected
             * @param {Array} selections Array of currently selected nodes
             */
            /**
             * @cfg {String/Array} tpl
             * The HTML fragment or an array of fragments that will make up the template used by this DataView.  This should
             * be specified in the same format expected by the constructor of {@link Ext.XTemplate}.
             */
            /**
             * @cfg {Ext.data.Store} store
             * The {@link Ext.data.Store} to binding this DataView to.
             */
            /**
             * @cfg {String} itemSelector
             * &lt;b&gt;This is a required setting&lt;/b&gt;. A simple CSS selector (e.g. &lt;tt&gt;div.some-class&lt;/tt&gt; or
             * &lt;tt&gt;span:first-child&lt;/tt&gt;) that will be used to determine what nodes this DataView will be
             * working with.
             */
            /**
             * @cfg {Boolean} multiSelect
             * True to allow selection of more than one item at a time, false to allow selection of only a single item
             * at a time or no selection at all, depending on the value of {@link #singleSelect} (defaults to false).
             */
            /**
             * @cfg {Boolean} singleSelect
             * True to allow selection of exactly one item at a time, false to allow no selection at all (defaults to false).
             * Note that if {@link #multiSelect} = true, this value will be ignored.
             */
            /**
             * @cfg {Boolean} simpleSelect
             * True to enable multiselection by clicking on multiple items without requiring the user to hold Shift or Ctrl,
             * false to force the user to hold Ctrl or Shift to select more than on item (defaults to false).
             */
            /**
             * @cfg {String} overClass
             * A CSS class to apply to each item in the view on mouseover (defaults to undefined).
             */
            /**
             * @cfg {String} loadingText
             * A string to display during data load operations (defaults to undefined).  If specified, this text will be
             * displayed in a loading div and the view&#x27;s contents will be cleared while loading, otherwise the view&#x27;s
             * contents will continue to display normally until the new data is loaded and the contents are replaced.
             */
            /**
             * @cfg {String} selectedClass
             * A CSS class to apply to each selected item in the view (defaults to &#x27;x-view-selected&#x27;).
             */
            selectedClass: &quot;j-view-selected&quot;,
            /**
             * @cfg {String} emptyText
             * The text to display in the view when there is no data to display (defaults to &#x27;&#x27;).
             */
            emptyText: &quot;&quot;,

            /**
             * @cfg {Boolean} deferEmptyText True to defer emptyText being applied until the store&#x27;s first load
             */
            deferEmptyText: true,
            /**
             * @cfg {Boolean} trackOver True to enable mouseenter and mouseleave events
             */
            trackOver: false,

            /**
             * @cfg {Boolean} blockRefresh Set this to true to ignore datachanged events on the bound store. This is useful if
             * you wish to provide custom transition animations via a plugin (defaults to false)
             */
            blockRefresh: false,

            //private
            last: false,

            // private
            initComponent: function () {
                jsuper(this);
                if ($.isString(this.tpl) || $.isArray(this.tpl)) {
                    this.tpl = $.tpl(this.tpl);
                }

                /*this.store = Ext.StoreMgr.lookup(this.store);
                 this.all = new Ext.CompositeElementLite();
                 this.selected = new Ext.CompositeElementLite();*/
            },

            // private
            afterRender: function () {
                jsuper(this);
                this.getTemplateTarget().on({
                    &quot;click&quot;: this.onClick,
                    &quot;dblclick&quot;: this.onDblClick,
                    &quot;contextmenu&quot;: this.onContextMenu,
                    scope: this
                });

                if (this.overClass || this.trackOver) {
                    this.getTemplateTarget().on({
                        &quot;mouseover&quot;: this.onMouseOver,
                        &quot;mouseout&quot;: this.onMouseOut,
                        scope: this
                    });
                }

                if (this.jde) {
                    this.bindJDE(this.jde, true);
                }
            },

            /**
             * Refreshes the view by reloading the data from the store and re-rendering the template.
             */
            refresh: function () {
                this.clearSelections(false, true);
                var el = this.getTemplateTarget();
                el.html(&quot;&quot;);
                var records = this.jde.get();
                if (records.length &lt; 1) {
                    if (!this.deferEmptyText || this.hasSkippedEmptyText) {
                        el.html(this.emptyText);
                    }
                    //this.all.clear();
                } else {
                    this.tpl.overwrite(el, this.prepareData(records));
                    //this.all.fill(Ext.query(this.itemSelector, el.dom));
                    //this.updateIndexes(0);
                }
                this.hasSkippedEmptyText = true;
            },

            getTemplateTarget: function () {
                return this.el;
            },

            /**
             * Function which can be overridden to provide custom formatting for each Record that is used by this
             * DataView&#x27;s {@link #tpl template} to render each node.
             * @param {Array/Object} data The raw data object that was used to create the Record.
             * @param {Number} recordIndex the index number of the Record being prepared for rendering.
             * @param {Record} record The Record being prepared for rendering.
             * @return {Array/Object} The formatted data in a format expected by the internal {@link #tpl template}&#x27;s overwrite() method.
             * (either an array if your params are numeric (i.e. {0}) or an object (i.e. {foo: &#x27;bar&#x27;}))
             */
            prepareData: function (data) {
                return data;
            },

            // private
            bufferRender: function (records) {
                var div = document.createElement(&#x27;div&#x27;);
                this.tpl.overwrite(div, this.collectData(records));
                return Ext.query(this.itemSelector, div);
            },

            // private
            onUpdate: function (ds, record) {
                var index = this.store.indexOf(record);
                if (index &gt; -1) {
                    var sel = this.isSelected(index);
                    var original = this.all.elements[index];
                    var node = this.bufferRender([record], index)[0];

                    this.all.replaceElement(index, node, true);
                    if (sel) {
                        this.selected.replaceElement(original, node);
                        this.all.item(index).addClass(this.selectedClass);
                    }
                    this.updateIndexes(index, index);
                }
            },

            // private
            onAdd: function (records, index) {
                console.log(records);
                /*if (this.all.getCount() === 0) {
                 this.refresh();
                 return;
                 }
                 var nodes = this.bufferRender(records, index), n, a = this.all.elements;
                 if (index &lt; this.all.getCount()) {
                 n = this.all.item(index).insertSibling(nodes, &#x27;before&#x27;, true);
                 a.splice.apply(a, [index, 0].concat(nodes));
                 } else {
                 n = this.all.last().insertSibling(nodes, &#x27;after&#x27;, true);
                 a.push.apply(a, nodes);
                 }
                 this.updateIndexes(index);*/
                this.refresh();
            },

            // private
            onRemove: function (ds, record, index) {
                /*this.deselect(index);
                 this.all.removeElement(index, true);
                 this.updateIndexes(index);
                 if (this.store.getCount() === 0) {

                 }*/
                this.refresh();
            },

            /**
             * Refreshes an individual node&#x27;s data from the store.
             * @param {Number} index The item&#x27;s data index in the store
             */
            refreshNode: function (index) {
                this.onUpdate(this.store, this.store.getAt(index));
            },

            // private
            updateIndexes: function (startIndex, endIndex) {
                var ns = this.all.elements;
                startIndex = startIndex || 0;
                endIndex = endIndex || ((endIndex === 0) ? 0 : (ns.length - 1));
                for (var i = startIndex; i &lt;= endIndex; i++) {
                    ns[i].viewIndex = i;
                }
            },

            /**
             * Returns the store associated with this DataView.
             * @return {Ext.data.Store} The store
             */
            getJDE: function () {
                return this.jde;
            },

            /**
             * Changes the data store bound to this view and refreshes it.
             * @param {Store} store The store to binding to this view
             */
            bindJDE: function (jde, initial) {
                if (!initial &amp;&amp; this.jde) {
                    if (jde !== this.jde &amp;&amp; this.jde.autoDestroy) {
                        this.jde.destroy();
                    } else {
                        this.jde.off(&quot;beforeload&quot;, this.onBeforeLoad, this);
                        this.jde.off(&quot;datachanged&quot;, this.onDataChanged, this);
                        this.jde.off(&quot;docinsert&quot;, this.onAdd, this);
                        this.jde.off(&quot;doccommit&quot;, this.onRemove, this);
                        this.jde.off(&quot;docupdate&quot;, this.onUpdate, this);
                        this.jde.off(&quot;clear&quot;, this.refresh, this);
                    }
                    if (!jde) {
                        this.store = null;
                    }
                }
                if (jde) {
                    this.jde = jde;
                    this.jde.on(&quot;beforeload&quot;, this.onBeforeLoad, this);
                    this.jde.on(&quot;datachanged&quot;, this.onDataChanged, this);
                    this.jde.on(&quot;docinsert&quot;, this.onAdd, this);
                    this.jde.on(&quot;doccommit&quot;, this.onRemove, this);
                    this.jde.on(&quot;docupdate&quot;, this.onUpdate, this);
                    //this.jde.on(&quot;clear&quot;, this.refresh, this);
                    this.refresh();
                }

            },

            /**
             * @private
             * Calls this.refresh if this.blockRefresh is not true
             */
            onDataChanged: function () {
                if (this.blockRefresh !== true) {
                    this.refresh.apply(this, arguments);
                }
            },

            /**
             * Returns the template node the passed child belongs to, or null if it doesn&#x27;t belong to one.
             * @param {HTMLElement} node
             * @return {HTMLElement} The template node
             */
            findItemFromChild: function (node) {
                return Ext.fly(node).findParent(this.itemSelector, this.getTemplateTarget());
            },

            // private
            onClick: function (e) {
                var item = e.getTarget(this.itemSelector, this.getTemplateTarget());
                if (item) {
                    var index = this.indexOf(item);
                    if (this.onItemClick(item, index, e) !== false) {
                        this.fireEvent(&quot;click&quot;, this, index, item, e);
                    }
                } else {
                    if (this.fireEvent(&quot;containerclick&quot;, this, e) !== false) {
                        this.onContainerClick(e);
                    }
                }
            },

            onContainerClick: function (e) {
                this.clearSelections();
            },

            // private
            onContextMenu: function (e) {
                var item = e.getTarget(this.itemSelector, this.getTemplateTarget());
                if (item) {
                    this.fireEvent(&quot;contextmenu&quot;, this, this.indexOf(item), item, e);
                } else {
                    this.fireEvent(&quot;containercontextmenu&quot;, this, e);
                }
            },

            // private
            onDblClick: function (e) {
                var item = e.getTarget(this.itemSelector, this.getTemplateTarget());
                if (item) {
                    this.fireEvent(&quot;dblclick&quot;, this, this.indexOf(item), item, e);
                }
            },

            // private
            onMouseOver: function (e) {
                var item = e.getTarget(this.itemSelector, this.getTemplateTarget());
                if (item &amp;&amp; item !== this.lastItem) {
                    this.lastItem = item;
                    $(item).addClass(this.overClass);
                    //this.fireEvent(&quot;mouseenter&quot;, this, this.indexOf(item), item, e);
                }
            },

            // private
            onMouseOut: function (e) {
                if (this.lastItem) {
                    if (!e.within(this.lastItem, true, true)) {
                        $(this.lastItem).removeClass(this.overClass);
                        //this.fireEvent(&quot;mouseleave&quot;, this, this.indexOf(this.lastItem), this.lastItem, e);
                        delete this.lastItem;
                    }
                }
            },

            // private
            onItemClick: function (item, index, e) {
                if (this.fireEvent(&quot;beforeclick&quot;, this, index, item, e) === false) {
                    return false;
                }
                if (this.multiSelect) {
                    this.doMultiSelection(item, index, e);
                    e.preventDefault();
                } else if (this.singleSelect) {
                    this.doSingleSelection(item, index, e);
                    e.preventDefault();
                }
                return true;
            },

            // private
            doSingleSelection: function (item, index, e) {
                if (e.ctrlKey &amp;&amp; this.isSelected(index)) {
                    this.deselect(index);
                } else {
                    this.select(index, false);
                }
            },

            // private
            doMultiSelection: function (item, index, e) {
                if (e.shiftKey &amp;&amp; this.last !== false) {
                    var last = this.last;
                    this.selectRange(last, index, e.ctrlKey);
                    this.last = last; // reset the last
                } else {
                    if ((e.ctrlKey || this.simpleSelect) &amp;&amp; this.isSelected(index)) {
                        this.deselect(index);
                    } else {
                        this.select(index, e.ctrlKey || e.shiftKey || this.simpleSelect);
                    }
                }
            },

            /**
             * Gets the number of selected nodes.
             * @return {Number} The node count
             */
            getSelectionCount: function () {
                return this.selected.getCount();
            },

            /**
             * Gets the currently selected nodes.
             * @return {Array} An array of HTMLElements
             */
            getSelectedNodes: function () {
                return this.selected.elements;
            },

            /**
             * Gets the indexes of the selected nodes.
             * @return {Array} An array of numeric indexes
             */
            getSelectedIndexes: function () {
                var indexes = [], s = this.selected.elements;
                for (var i = 0, len = s.length; i &lt; len; i++) {
                    indexes.push(s[i].viewIndex);
                }
                return indexes;
            },

            /**
             * Gets an array of the selected records
             * @return {Array} An array of {@link Ext.data.Record} objects
             */
            getSelectedRecords: function () {
                var r = [], s = this.selected.elements;
                for (var i = 0, len = s.length; i &lt; len; i++) {
                    r[r.length] = this.store.getAt(s[i].viewIndex);
                }
                return r;
            },

            /**
             * Gets an array of the records from an array of nodes
             * @param {Array} nodes The nodes to evaluate
             * @return {Array} records The {@link Ext.data.Record} objects
             */
            getRecords: function (nodes) {
                var r = [], s = nodes;
                for (var i = 0, len = s.length; i &lt; len; i++) {
                    r[r.length] = this.store.getAt(s[i].viewIndex);
                }
                return r;
            },

            /**
             * Gets a record from a node
             * @param {HTMLElement} node The node to evaluate
             * @return {Record} record The {@link Ext.data.Record} object
             */
            getRecord: function (node) {
                return this.store.getAt(node.viewIndex);
            },

            /**
             * Clears all selections.
             * @param {Boolean} suppressEvent (optional) True to skip firing of the selectionchange event
             */
            clearSelections: function (suppressEvent, skipUpdate) {
                /*if ((this.multiSelect || this.singleSelect) &amp;&amp; this.selected.getCount() &gt; 0) {
                 if (!skipUpdate) {
                 this.selected.removeClass(this.selectedClass);
                 }
                 this.selected.clear();
                 this.last = false;
                 if (!suppressEvent) {
                 this.fireEvent(&quot;selectionchange&quot;, this, this.selected.elements);
                 }
                 }*/
            },

            /**
             * Returns true if the passed node is selected, else false.
             * @param {HTMLElement/Number} node The node or node index to check
             * @return {Boolean} True if selected, else false
             */
            isSelected: function (node) {
                return this.selected.contains(this.getNode(node));
            },

            /**
             * Deselects a node.
             * @param {HTMLElement/Number} node The node to deselect
             */
            deselect: function (node) {
                if (this.isSelected(node)) {
                    node = this.getNode(node);
                    this.selected.removeElement(node);
                    if (this.last == node.viewIndex) {
                        this.last = false;
                    }
                    $(node).removeClass(this.selectedClass);
                    this.fireEvent(&quot;selectionchange&quot;, this, this.selected.elements);
                }
            },

            /**
             * Selects a set of nodes.
             * @param {Array/HTMLElement/String/Number} nodeInfo An HTMLElement template node, index of a template node,
             * id of a template node or an array of any of those to select
             * @param {Boolean} keepExisting (optional) true to keep existing selections
             * @param {Boolean} suppressEvent (optional) true to skip firing of the selectionchange vent
             */
            select: function (nodeInfo, keepExisting, suppressEvent) {
                if ($.isArray(nodeInfo)) {
                    if (!keepExisting) {
                        this.clearSelections(true);
                    }
                    for (var i = 0, len = nodeInfo.length; i &lt; len; i++) {
                        this.select(nodeInfo[i], true, true);
                    }
                    if (!suppressEvent) {
                        this.fireEvent(&quot;selectionchange&quot;, this, this.selected.elements);
                    }
                } else {
                    var node = this.getNode(nodeInfo);
                    if (!keepExisting) {
                        this.clearSelections(true);
                    }
                    if (node &amp;&amp; !this.isSelected(node)) {
                        if (this.fireEvent(&quot;beforeselect&quot;, this, node, this.selected.elements) !== false) {
                            $.fly(node).addClass(this.selectedClass);
                            this.selected.add(node);
                            this.last = node.viewIndex;
                            if (!suppressEvent) {
                                this.fireEvent(&quot;selectionchange&quot;, this, this.selected.elements);
                            }
                        }
                    }
                }
            },

            /**
             * Selects a range of nodes. All nodes between start and end are selected.
             * @param {Number} start The index of the first node in the range
             * @param {Number} end The index of the last node in the range
             * @param {Boolean} keepExisting (optional) True to retain existing selections
             */
            selectRange: function (start, end, keepExisting) {
                if (!keepExisting) {
                    this.clearSelections(true);
                }
                this.select(this.getNodes(start, end), true);
            },

            /**
             * Gets a template node.
             * @param {HTMLElement/String/Number} nodeInfo An HTMLElement template node, index of a template node or the id of a template node
             * @return {HTMLElement} The node or null if it wasn&#x27;t found
             */
            getNode: function (nodeInfo) {
                if ($.isString(nodeInfo)) {
                    return document.getElementById(nodeInfo);
                } else if ($.isNumber(nodeInfo)) {
                    return this.all.elements[nodeInfo];
                }
                return nodeInfo;
            },

            /**
             * Gets a range nodes.
             * @param {Number} start (optional) The index of the first node in the range
             * @param {Number} end (optional) The index of the last node in the range
             * @return {Array} An array of nodes
             */
            getNodes: function (start, end) {
                var ns = this.all.elements;
                start = start || 0;
                end = !$.isDefined(end) ? Math.max(ns.length - 1, 0) : end;
                var nodes = [], i;
                if (start &lt;= end) {
                    for (i = start; i &lt;= end &amp;&amp; ns[i]; i++) {
                        nodes.push(ns[i]);
                    }
                } else {
                    for (i = start; i &gt;= end &amp;&amp; ns[i]; i--) {
                        nodes.push(ns[i]);
                    }
                }
                return nodes;
            },

            /**
             * Finds the index of the passed node.
             * @param {HTMLElement/String/Number} nodeInfo An HTMLElement template node, index of a template node or the id of a template node
             * @return {Number} The index of the node or -1
             */
            indexOf: function (node) {
                node = this.getNode(node);
                if ($.isNumber(node.viewIndex)) {
                    return node.viewIndex;
                }
                return this.all.indexOf(node);
            },

            // private
            onBeforeLoad: function () {
                if (this.loadingText) {
                    this.clearSelections(false, true);
                    this.getTemplateTarget().update(&#x27;&lt;div class=&quot;loading-indicator&quot;&gt;&#x27; + this.loadingText + &#x27;&lt;/div&gt;&#x27;);
                    this.all.clear();
                }
            },

            onDestroy: function () {
                this.all.clear();
                this.selected.clear();
                jsuper(this);
                this.bindJDE(null);
            }
        });

    }, &#x27;dataview&#x27;);

});
</pre>

</div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/js/tabs.js"></script>
</body>
</html>
