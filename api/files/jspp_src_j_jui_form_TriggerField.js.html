<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>jspp/src/j/jui/form/TriggerField.js - The Js++ Language</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.8.0pr2/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <script src="http://yui.yahooapis.com/combo?3.8.0pr2/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            <h1><a href="../index.html"><img src="../assets/css/logo.png">The Js++ Language: jspp/src/j/jui/form/TriggerField.js</a></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 1.0.0</em>
        </div>
    </div>
    <div class="yui3-g">

        <div id="sidebar" class="yui3-u">
            <div id="modules" class="sidebox">
    <div class="hd">
        <h2 class="no-toc">Modules</h2>
    </div>
    <div class="bd">
        <ul>
            
                <li><a href="../modules/DOM_UNIT.html">DOM_UNIT</a>
                
                </li>
            
                <li><a href="../modules/jui.html">jui</a>
                
                </li>
            
                <li><a href="../modules/junit.html">junit</a>
                
                </li>
            
                <li><a href="../modules/OOP.html">OOP</a>
                
                </li>
            
        </ul>
    </div>
</div>

<div id="classes" class="sidebox">
    <div class="hd">
        <h2 class="no-toc">Classes</h2>
    </div>
    <div class="bd">
        <ul>
            
                <li><a href="../classes/dataview.html">dataview</a></li>
            
                <li><a href="../classes/Jclass.html">Jclass</a></li>
            
                <li><a href="../classes/jde.DataProxy.html">jde.DataProxy</a></li>
            
                <li><a href="../classes/jde.JsonReader.html">jde.JsonReader</a></li>
            
                <li><a href="../classes/JDEngine.html">JDEngine</a></li>
            
                <li><a href="../classes/jdengine.html">jdengine</a></li>
            
                <li><a href="../classes/jsonreader.html">jsonreader</a></li>
            
                <li><a href="../classes/jui.Component.html">jui.Component</a></li>
            
                <li><a href="../classes/jui.DataView.html">jui.DataView</a></li>
            
                <li><a href="../classes/jui.form.Checkbox.html">jui.form.Checkbox</a></li>
            
                <li><a href="../classes/jui.form.ComboBox.html">jui.form.ComboBox</a></li>
            
                <li><a href="../classes/jui.form.Field.html">jui.form.Field</a></li>
            
                <li><a href="../classes/jui.form.Hidden.html">jui.form.Hidden</a></li>
            
                <li><a href="../classes/jui.form.NumberFiled.html">jui.form.NumberFiled</a></li>
            
                <li><a href="../classes/jui.form.Radio.html">jui.form.Radio</a></li>
            
                <li><a href="../classes/jui.form.TextArea.html">jui.form.TextArea</a></li>
            
                <li><a href="../classes/jui.form.TextField.html">jui.form.TextField</a></li>
            
                <li><a href="../classes/jui.form.TriggerField.html">jui.form.TriggerField</a></li>
            
                <li><a href="../classes/jui.form.TwinTriggerField.html">jui.form.TwinTriggerField</a></li>
            
                <li><a href="../classes/jui.Layer.html">jui.Layer</a></li>
            
                <li><a href="../classes/junit.BaseTemplate.html">junit.BaseTemplate</a></li>
            
                <li><a href="../classes/junit.JTemplate.html">junit.JTemplate</a></li>
            
                <li><a href="../classes/junit.MixedCollection.html">junit.MixedCollection</a></li>
            
                <li><a href="../classes/junit.Observable.html">junit.Observable</a></li>
            
                <li><a href="../classes/junit.STemplate.html">junit.STemplate</a></li>
            
                <li><a href="../classes/junit.Template.html">junit.Template</a></li>
            
                <li><a href="../classes/Opp.html">Opp</a></li>
            
        </ul>
    </div>
</div>










<div id="fileTree" class="sidebox">
    <div class="hd">
        <h2 class="no-toc">Files</h2>
    </div>
    <div class="bd">
        <ul><li>jspp/<ul><li>src/<ul><li>core/<ul><li><a href="../files/jspp_src_core_j.js.html">j.js</a></li><li><a href="../files/jspp_src_core_oop.js.html">oop.js</a></li></ul></li><li>j/<ul><li>jde/<ul><li><a href="../files/jspp_src_j_jde_DataProxy.js.html">DataProxy.js</a></li><li><a href="../files/jspp_src_j_jde_JDEngine.js.html">JDEngine.js</a></li><li><a href="../files/jspp_src_j_jde_JsonReader.js.html">JsonReader.js</a></li></ul></li><li>jui/<ul><li><a href="../files/jspp_src_j_jui_Component.js.html">Component.js</a></li><li><a href="../files/jspp_src_j_jui_DataView.js.html">DataView.js</a></li><li><a href="../files/jspp_src_j_jui_Layer.js.html">Layer.js</a></li><li>form/<ul><li><a href="../files/jspp_src_j_jui_form_Checkbox.js.html">Checkbox.js</a></li><li><a href="../files/jspp_src_j_jui_form_ComboBox.js.html">ComboBox.js</a></li><li><a href="../files/jspp_src_j_jui_form_Field.js.html">Field.js</a></li><li><a href="../files/jspp_src_j_jui_form_Hidden.js.html">Hidden.js</a></li><li><a href="../files/jspp_src_j_jui_form_NumberField.js.html">NumberField.js</a></li><li><a href="../files/jspp_src_j_jui_form_Radio.js.html">Radio.js</a></li><li><a href="../files/jspp_src_j_jui_form_TextArea.js.html">TextArea.js</a></li><li><a href="../files/jspp_src_j_jui_form_TextField.js.html">TextField.js</a></li><li><a href="../files/jspp_src_j_jui_form_TriggerField.js.html">TriggerField.js</a></li></ul></li></ul></li><li>junit/<ul><li><a href="../files/jspp_src_j_junit_MixedCollection.js.html">MixedCollection.js</a></li><li><a href="../files/jspp_src_j_junit_Observable.js.html">Observable.js</a></li><li><a href="../files/jspp_src_j_junit_Template.js.html">Template.js</a></li><li><a href="../files/jspp_src_j_junit_XTemplate.js.html">XTemplate.js</a></li></ul></li></ul></li></ul></li></ul></li></ul>
    </div>
</div>



        </div>

        <div id="main" class="yui3-u">
            <div class="content"><h4>jspp/src/j/jui/form/TriggerField.js</h4>

<pre class="code prettyprint linenums">
/**
 * @pakcage jui.form
 */
&#x27;package jui.form&#x27;.j(function () {
    /**
     * @class jui.form.TriggerField
     * @extends jui.form.TextField
     */
    &#x27;class TriggerField extends TextField&#x27;.j(function () {
        /**
         * @cfg {String} triggerClass
         * An additional CSS class used to style the trigger button.  The trigger will always get the
         * class &lt;tt&gt;&#x27;x-form-trigger&#x27;&lt;/tt&gt; by default and &lt;tt&gt;triggerClass&lt;/tt&gt; will be &lt;b&gt;appended&lt;/b&gt; if specified.
         */
        /**
         * @cfg {Mixed} triggerConfig
         * &lt;p&gt;A config object specifying the structure of the
         * trigger element for this Field. (Optional).&lt;/p&gt;
         * &lt;p&gt;Specify this when you need a customized element to act as the trigger button for a TriggerField.&lt;/p&gt;
         * &lt;p&gt;Note that when using this option, it is the developer&#x27;s responsibility to ensure correct sizing, positioning
         * and appearance of the trigger.  Defaults to:&lt;/p&gt;
         * &lt;pre&gt;&lt;code&gt;{tag: &quot;img&quot;, src: $.BLANK_IMAGE_URL, cls: &quot;x-form-trigger &quot; + this.triggerClass}&lt;/code&gt;&lt;/pre&gt;
         */

        jprotected({
            defaultAutoCreate: {tag: &quot;input&quot;, type: &quot;text&quot;, size: &quot;16&quot;, autocomplete: &quot;off&quot;},
            /**
             * @cfg {Boolean} hideTrigger &lt;tt&gt;true&lt;/tt&gt; to hide the trigger element and display only the base
             * text field (defaults to &lt;tt&gt;false&lt;/tt&gt;)
             */
            hideTrigger: false,
            /**
             * @cfg {Boolean} editable &lt;tt&gt;false&lt;/tt&gt; to prevent the user from typing text directly into the field,
             * the field will only respond to a click on the trigger to set the value. (defaults to &lt;tt&gt;true&lt;/tt&gt;).
             */
            editable: true,
            /**
             * @cfg {Boolean} readOnly &lt;tt&gt;true&lt;/tt&gt; to prevent the user from changing the field, and
             * hides the trigger.  Superceeds the editable and hideTrigger options if the value is true.
             * (defaults to &lt;tt&gt;false&lt;/tt&gt;)
             */
            readOnly: false,
            /**
             * @cfg {String} wrapFocusClass The class added to the to the wrap of the trigger element. Defaults to
             * &lt;tt&gt;x-trigger-wrap-focus&lt;/tt&gt;.
             */
            wrapFocusClass: &#x27;j-trigger-wrap-focus&#x27;,
            /**
             * @hide
             * @method autoSize
             */
            autoSize: $.noop,
            // private
            monitorTab: true,
            // private
            deferHeight: true,
            // private
            mimicing: false,

            actionMode: &#x27;wrap&#x27;,

            defaultTriggerWidth: 17
        });

        jprotected({
            onResize: function (w, h) {
                jsuper(this);
                var tw = this.getTriggerWidth();
                if ($.isNumber(w)) {
                    this.el.width(w - tw);
                }
                this.wrap.width(this.el.width() + tw);
            },

            getTriggerWidth: function () {
                var tw = this.trigger.width();
                if (!this.hideTrigger &amp;&amp; !this.readOnly &amp;&amp; tw === 0) {
                    tw = this.defaultTriggerWidth;
                }
                return tw;
            },

            // private
            alignErrorIcon: function () {
                if (this.wrap) {
                    this.errorIcon.alignTo(this.wrap, &#x27;tl-tr&#x27;, [2, 0]);
                }
            },

            // private
            onRender: function (ct, position) {
                this.doc = $.getBody();
                jsuper(this);

                this.wrap = this.el.wrap({cls: &#x27;j-form-field-wrap j-form-field-trigger-wrap&#x27;});
                this.trigger = this.wrap.createChild(this.triggerConfig ||
                {tag: &quot;img&quot;, src: $.BLANK_IMAGE_URL, cls: &quot;j-form-trigger &quot; + this.triggerClass});
                this.initTrigger();
                if (!this.width) {
                    this.wrap.width(this.el.width() + this.trigger.width());
                }
                this.resizeEl = this.positionEl = this.wrap;
            },


            // private
            initTrigger: function () {
                this.trigger.on(&#x27;click&#x27;, this.onTriggerClick, this);
                //this.trigger.addClassOnOver(&#x27;j-form-trigger-over&#x27;);
                //this.trigger.addClassOnClick(&#x27;j-form-trigger-click&#x27;);
            },

            // private
            onDestroy: function () {
                $.destroy(this.trigger, this.wrap);
                if (this.mimicing) {
                    this.doc.off(&#x27;mousedown&#x27;, this.mimicBlur, this);
                }
                delete this.doc;
                jsuper(this);
            },

            // private
            onFocus: function () {
                jsuper(this);
                if (!this.mimicing) {
                    this.wrap.addClass(this.wrapFocusClass);
                    this.mimicing = true;
                    this.doc.on(&#x27;mousedown&#x27;, this.mimicBlur, this);
                    if (this.monitorTab) {
                        this.el.on(&#x27;specialkey&#x27;, this.checkTab, this);
                    }
                }
            },

            // private
            checkTab: function (me, e) {
                if (e.getKey() == e.TAB) {
                    this.triggerBlur();
                }
            },


            // private
            mimicBlur: function (e) {
                /*if (!this.isDestroyed &amp;&amp; !this.wrap.contains(e.target) &amp;&amp; this.validateBlur(e)) {
                 this.triggerBlur();
                 }*/
            },

            // private
            triggerBlur: function () {
                this.mimicing = false;
                this.doc.off(&#x27;mousedown&#x27;, this.mimicBlur, this);
                if (this.monitorTab &amp;&amp; this.el) {
                    this.off(&#x27;specialkey&#x27;, this.checkTab, this);
                }
                jsuper(this);
                if (this.wrap) {
                    this.wrap.removeClass(this.wrapFocusClass);
                }
            },

            afterRender: function () {
                jsuper(this);
                this.updateEditState();
            },

            // private
            // This should be overriden by any subclass that needs to check whether or not the field can be blurred.
            validateBlur: function (e) {
                return true;
            }


        });

        jpublic({
            updateEditState: function () {
                if (this.rendered) {
                    if (this.readOnly) {
                        this.el.dom.readOnly = true;
                        this.el.addClass(&#x27;x-trigger-noedit&#x27;);
                        this.el.on(&#x27;click&#x27;, this.onTriggerClick, this);
                        this.trigger.hide();
                    } else {
                        if (!this.editable) {
                            this.el.dom.readOnly = true;
                            this.el.addClass(&#x27;x-trigger-noedit&#x27;);
                            this.el.on(&#x27;click&#x27;, this.onTriggerClick, this);
                        } else {
                            this.el.dom.readOnly = false;
                            this.el.removeClass(&#x27;x-trigger-noedit&#x27;);
                            this.el.off(&#x27;click&#x27;, this.onTriggerClick, this);
                        }
                        this.trigger.toggle(!this.hideTrigger);
                    }
                    this.onResize(this.width || this.wrap.width());
                }
            },

            setHideTrigger: function (hideTrigger) {
                if (hideTrigger != this.hideTrigger) {
                    this.hideTrigger = hideTrigger;
                    this.updateEditState();
                }
            },

            /**
             * @param {Boolean} value True to allow the user to directly edit the field text
             * Allow or prevent the user from directly editing the field text.  If false is passed,
             * the user will only be able to modify the field using the trigger.  Will also add
             * a click event to the text field which will call the trigger. This method
             * is the runtime equivalent of setting the &#x27;editable&#x27; config option at config time.
             */
            setEditable: function (editable) {
                if (editable != this.editable) {
                    this.editable = editable;
                    this.updateEditState();
                }
            },

            /**
             * @param {Boolean} value True to prevent the user changing the field and explicitly
             * hide the trigger.
             * Setting this to true will superceed settings editable and hideTrigger.
             * Setting this to false will defer back to editable and hideTrigger. This method
             * is the runtime equivalent of setting the &#x27;readOnly&#x27; config option at config time.
             */
            setReadOnly: function (readOnly) {
                if (readOnly != this.readOnly) {
                    this.readOnly = readOnly;
                    this.updateEditState();
                }
            },


            onBlur: $.noop,

            beforeBlur: $.noop,
            /**
             * The function that should handle the trigger&#x27;s click event.  This method does nothing by default
             * until overridden by an implementing function.  See Ext.form.ComboBox and Ext.form.DateField for
             * sample implementations.
             * @method
             * @param {EventObject} e
             */
            onTriggerClick: $.noop
        });

    }, &#x27;triggerfield&#x27;);

    /**
     * @class jui.form.TwinTriggerField
     * @extends jui.form.TriggerField
     */
    &#x27;class TwinTriggerField extends TriggerField&#x27;.j(function () {

        /**
         * @cfg {Mixed} triggerConfig
         * &lt;p&gt;A  config object specifying the structure of the trigger elements
         * for this Field. (Optional).&lt;/p&gt;
         * &lt;p&gt;Specify this when you need a customized element to contain the two trigger elements for this Field.
         * Each trigger element must be marked by the CSS class &lt;tt&gt;x-form-trigger&lt;/tt&gt; (also see
         * &lt;tt&gt;{@link #trigger1Class}&lt;/tt&gt; and &lt;tt&gt;{@link #trigger2Class}&lt;/tt&gt;).&lt;/p&gt;
         * &lt;p&gt;Note that when using this option, it is the developer&#x27;s responsibility to ensure correct sizing,
         * positioning and appearance of the triggers.&lt;/p&gt;
         */
        /**
         * @cfg {String} trigger1Class
         * An additional CSS class used to style the trigger button.  The trigger will always get the
         * class &lt;tt&gt;&#x27;x-form-trigger&#x27;&lt;/tt&gt; by default and &lt;tt&gt;triggerClass&lt;/tt&gt; will be &lt;b&gt;appended&lt;/b&gt; if specified.
         */
        /**
         * @cfg {String} trigger2Class
         * An additional CSS class used to style the trigger button.  The trigger will always get the
         * class &lt;tt&gt;&#x27;x-form-trigger&#x27;&lt;/tt&gt; by default and &lt;tt&gt;triggerClass&lt;/tt&gt; will be &lt;b&gt;appended&lt;/b&gt; if specified.
         */
        jprotected({
            initComponent: function () {
                jsuper(this);

                this.triggerConfig = {
                    tag: &#x27;span&#x27;, cls: &#x27;x-form-twin-triggers&#x27;, cn: [
                        {tag: &quot;img&quot;, src: $.BLANK_IMAGE_URL, cls: &quot;x-form-trigger &quot; + this.trigger1Class},
                        {tag: &quot;img&quot;, src: $.BLANK_IMAGE_URL, cls: &quot;x-form-trigger &quot; + this.trigger2Class}
                    ]};
            },

            getTrigger: function (index) {
                return this.triggers[index];
            },

            initTrigger: function () {
                var ts = this.trigger.select(&#x27;.x-form-trigger&#x27;, true);
                var triggerField = this;
                ts.each(function (t, all, index) {
                    var triggerIndex = &#x27;Trigger&#x27; + (index + 1);
                    t.hide = function () {
                        var w = triggerField.wrap.getWidth();
                        this.dom.style.display = &#x27;none&#x27;;
                        triggerField.el.setWidth(w - triggerField.trigger.getWidth());
                        this[&#x27;hidden&#x27; + triggerIndex] = true;
                    };
                    t.show = function () {
                        var w = triggerField.wrap.getWidth();
                        this.dom.style.display = &#x27;&#x27;;
                        triggerField.el.setWidth(w - triggerField.trigger.getWidth());
                        this[&#x27;hidden&#x27; + triggerIndex] = false;
                    };

                    if (this[&#x27;hide&#x27; + triggerIndex]) {
                        t.dom.style.display = &#x27;none&#x27;;
                        this[&#x27;hidden&#x27; + triggerIndex] = true;
                    }
                    t.on(&#x27;click&#x27;, this[&#x27;on&#x27; + triggerIndex + &#x27;Click&#x27;], this);
                    //t.addClassOnOver(&#x27;x-form-trigger-over&#x27;);
                    //t.addClassOnClick(&#x27;x-form-trigger-click&#x27;);
                }, this);
                this.triggers = ts.elements;
            },

            getTriggerWidth: function () {
                var tw = 0;
                $.each(this.triggers, function (t, index) {
                    var triggerIndex = &#x27;Trigger&#x27; + (index + 1),
                        w = t.getWidth();
                    if (w === 0 &amp;&amp; !this[&#x27;hidden&#x27; + triggerIndex]) {
                        tw += this.defaultTriggerWidth;
                    } else {
                        tw += w;
                    }
                }, this);
                return tw;
            },

            // private
            onDestroy: function () {
                $.destroy(this.triggers);
                jsuper(this);
            }
        });

        jpublic({
            /**
             * The function that should handle the trigger&#x27;s click event.  This method does nothing by default
             * until overridden by an implementing function. See {@link Ext.form.TriggerField#onTriggerClick}
             * for additional information.
             * @method
             * @param {EventObject} e
             */
            onTrigger1Click: $.noop,
            /**
             * The function that should handle the trigger&#x27;s click event.  This method does nothing by default
             * until overridden by an implementing function. See {@link Ext.form.TriggerField#onTriggerClick}
             * for additional information.
             * @method
             * @param {EventObject} e
             */
            onTrigger2Click: $.noop
        });

    });

});
</pre>

</div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/js/tabs.js"></script>
</body>
</html>
