<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>jspp/src/j/jui/form/TextField.js - The Js++ Language</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.8.0pr2/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <script src="http://yui.yahooapis.com/combo?3.8.0pr2/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            <h1><a href="../index.html"><img src="../assets/css/logo.png">The Js++ Language: jspp/src/j/jui/form/TextField.js</a></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 1.0.0</em>
        </div>
    </div>
    <div class="yui3-g">

        <div id="sidebar" class="yui3-u">
            <div id="modules" class="sidebox">
    <div class="hd">
        <h2 class="no-toc">Modules</h2>
    </div>
    <div class="bd">
        <ul>
            
                <li><a href="../modules/DOM_UNIT.html">DOM_UNIT</a>
                
                </li>
            
                <li><a href="../modules/jui.html">jui</a>
                
                </li>
            
                <li><a href="../modules/junit.html">junit</a>
                
                </li>
            
                <li><a href="../modules/OOP.html">OOP</a>
                
                </li>
            
        </ul>
    </div>
</div>

<div id="classes" class="sidebox">
    <div class="hd">
        <h2 class="no-toc">Classes</h2>
    </div>
    <div class="bd">
        <ul>
            
                <li><a href="../classes/dataview.html">dataview</a></li>
            
                <li><a href="../classes/Jclass.html">Jclass</a></li>
            
                <li><a href="../classes/jde.DataProxy.html">jde.DataProxy</a></li>
            
                <li><a href="../classes/jde.JsonReader.html">jde.JsonReader</a></li>
            
                <li><a href="../classes/JDEngine.html">JDEngine</a></li>
            
                <li><a href="../classes/jdengine.html">jdengine</a></li>
            
                <li><a href="../classes/jsonreader.html">jsonreader</a></li>
            
                <li><a href="../classes/jui.Component.html">jui.Component</a></li>
            
                <li><a href="../classes/jui.DataView.html">jui.DataView</a></li>
            
                <li><a href="../classes/jui.form.Checkbox.html">jui.form.Checkbox</a></li>
            
                <li><a href="../classes/jui.form.ComboBox.html">jui.form.ComboBox</a></li>
            
                <li><a href="../classes/jui.form.Field.html">jui.form.Field</a></li>
            
                <li><a href="../classes/jui.form.Hidden.html">jui.form.Hidden</a></li>
            
                <li><a href="../classes/jui.form.NumberFiled.html">jui.form.NumberFiled</a></li>
            
                <li><a href="../classes/jui.form.Radio.html">jui.form.Radio</a></li>
            
                <li><a href="../classes/jui.form.TextArea.html">jui.form.TextArea</a></li>
            
                <li><a href="../classes/jui.form.TextField.html">jui.form.TextField</a></li>
            
                <li><a href="../classes/jui.form.TriggerField.html">jui.form.TriggerField</a></li>
            
                <li><a href="../classes/jui.form.TwinTriggerField.html">jui.form.TwinTriggerField</a></li>
            
                <li><a href="../classes/jui.Layer.html">jui.Layer</a></li>
            
                <li><a href="../classes/junit.BaseTemplate.html">junit.BaseTemplate</a></li>
            
                <li><a href="../classes/junit.JTemplate.html">junit.JTemplate</a></li>
            
                <li><a href="../classes/junit.MixedCollection.html">junit.MixedCollection</a></li>
            
                <li><a href="../classes/junit.Observable.html">junit.Observable</a></li>
            
                <li><a href="../classes/junit.STemplate.html">junit.STemplate</a></li>
            
                <li><a href="../classes/junit.Template.html">junit.Template</a></li>
            
                <li><a href="../classes/Opp.html">Opp</a></li>
            
        </ul>
    </div>
</div>










<div id="fileTree" class="sidebox">
    <div class="hd">
        <h2 class="no-toc">Files</h2>
    </div>
    <div class="bd">
        <ul><li>jspp/<ul><li>src/<ul><li>core/<ul><li><a href="../files/jspp_src_core_j.js.html">j.js</a></li><li><a href="../files/jspp_src_core_oop.js.html">oop.js</a></li></ul></li><li>j/<ul><li>jde/<ul><li><a href="../files/jspp_src_j_jde_DataProxy.js.html">DataProxy.js</a></li><li><a href="../files/jspp_src_j_jde_JDEngine.js.html">JDEngine.js</a></li><li><a href="../files/jspp_src_j_jde_JsonReader.js.html">JsonReader.js</a></li></ul></li><li>jui/<ul><li><a href="../files/jspp_src_j_jui_Component.js.html">Component.js</a></li><li><a href="../files/jspp_src_j_jui_DataView.js.html">DataView.js</a></li><li><a href="../files/jspp_src_j_jui_Layer.js.html">Layer.js</a></li><li>form/<ul><li><a href="../files/jspp_src_j_jui_form_Checkbox.js.html">Checkbox.js</a></li><li><a href="../files/jspp_src_j_jui_form_ComboBox.js.html">ComboBox.js</a></li><li><a href="../files/jspp_src_j_jui_form_Field.js.html">Field.js</a></li><li><a href="../files/jspp_src_j_jui_form_Hidden.js.html">Hidden.js</a></li><li><a href="../files/jspp_src_j_jui_form_NumberField.js.html">NumberField.js</a></li><li><a href="../files/jspp_src_j_jui_form_Radio.js.html">Radio.js</a></li><li><a href="../files/jspp_src_j_jui_form_TextArea.js.html">TextArea.js</a></li><li><a href="../files/jspp_src_j_jui_form_TextField.js.html">TextField.js</a></li><li><a href="../files/jspp_src_j_jui_form_TriggerField.js.html">TriggerField.js</a></li></ul></li></ul></li><li>junit/<ul><li><a href="../files/jspp_src_j_junit_MixedCollection.js.html">MixedCollection.js</a></li><li><a href="../files/jspp_src_j_junit_Observable.js.html">Observable.js</a></li><li><a href="../files/jspp_src_j_junit_Template.js.html">Template.js</a></li><li><a href="../files/jspp_src_j_junit_XTemplate.js.html">XTemplate.js</a></li></ul></li></ul></li></ul></li></ul></li></ul>
    </div>
</div>



        </div>

        <div id="main" class="yui3-u">
            <div class="content"><h4>jspp/src/j/jui/form/TextField.js</h4>

<pre class="code prettyprint linenums">
/**
 * @pakcage jui.form
 */
&#x27;package jui.form&#x27;.j(function () {
    /**
     * @class jui.form.TextField
     * @extends jui.form.Field
     */
    &#x27;class TextField extends Field&#x27;.j(function () {

        jprotected({
            /**
             * @cfg {String} vtypeText A custom error message to display in place of the default message provided
             * for the &lt;b&gt;&lt;code&gt;{@link #vtype}&lt;/code&gt;&lt;/b&gt; currently set for this field (defaults to &lt;tt&gt;&#x27;&#x27;&lt;/tt&gt;).  &lt;b&gt;Note&lt;/b&gt;:
             * only applies if &lt;b&gt;&lt;code&gt;{@link #vtype}&lt;/code&gt;&lt;/b&gt; is set, else ignored.
             */
            /**
             * @cfg {RegExp} stripCharsRe A JavaScript RegExp object used to strip unwanted content from the value
             * before validation (defaults to &lt;tt&gt;null&lt;/tt&gt;).
             */
            /**
             * @cfg {Boolean} grow &lt;tt&gt;true&lt;/tt&gt; if this field should automatically grow and shrink to its content
             * (defaults to &lt;tt&gt;false&lt;/tt&gt;)
             */
            grow: false,
            /**
             * @cfg {Number} growMin The minimum width to allow when &lt;code&gt;&lt;b&gt;{@link #grow}&lt;/b&gt; = true&lt;/code&gt; (defaults
             * to &lt;tt&gt;30&lt;/tt&gt;)
             */
            growMin: 30,
            /**
             * @cfg {Number} growMax The maximum width to allow when &lt;code&gt;&lt;b&gt;{@link #grow}&lt;/b&gt; = true&lt;/code&gt; (defaults
             * to &lt;tt&gt;800&lt;/tt&gt;)
             */
            growMax: 800,
            /**
             * @cfg {String} vtype A validation type name as defined in {@link Ext.form.VTypes} (defaults to &lt;tt&gt;null&lt;/tt&gt;)
             */
            vtype: null,
            /**
             * @cfg {RegExp} maskRe An input mask regular expression that will be used to filter keystrokes that do
             * not match (defaults to &lt;tt&gt;null&lt;/tt&gt;)
             */
            maskRe: null,
            /**
             * @cfg {Boolean} disableKeyFilter Specify &lt;tt&gt;true&lt;/tt&gt; to disable input keystroke filtering (defaults
             * to &lt;tt&gt;false&lt;/tt&gt;)
             */
            disableKeyFilter: false,
            /**
             * @cfg {Boolean} allowBlank Specify &lt;tt&gt;false&lt;/tt&gt; to validate that the value&#x27;s length is &gt; 0 (defaults to
             * &lt;tt&gt;true&lt;/tt&gt;)
             */
            allowBlank: true,
            /**
             * @cfg {Number} minLength Minimum input field length required (defaults to &lt;tt&gt;0&lt;/tt&gt;)
             */
            minLength: 0,
            /**
             * @cfg {Number} maxLength Maximum input field length allowed by validation (defaults to Number.MAX_VALUE).
             * This behavior is intended to provide instant feedback to the user by improving usability to allow pasting
             * and editing or overtyping and back tracking. To restrict the maximum number of characters that can be
             * entered into the field use &lt;tt&gt;&lt;b&gt;{@link jui.form.Field#autoCreate autoCreate}&lt;/b&gt;&lt;/tt&gt; to add
             * any attributes you want to a field, for example:&lt;pre&gt;&lt;code&gt;
             var myField = new jui.form.NumberField({
                id: &#x27;mobile&#x27;,
                anchor:&#x27;90%&#x27;,
                fieldLabel: &#x27;Mobile&#x27;,
                maxLength: 16, // for validation
                autoCreate: {tag: &#x27;input&#x27;, type: &#x27;text&#x27;, size: &#x27;20&#x27;, autocomplete: &#x27;off&#x27;, maxlength: &#x27;10&#x27;}
            });
             &lt;/code&gt;&lt;/pre&gt;
             */
            maxLength: Number.MAX_VALUE,
            /**
             * @cfg {String} minLengthText Error text to display if the &lt;b&gt;&lt;tt&gt;{@link #minLength minimum length}&lt;/tt&gt;&lt;/b&gt;
             * validation fails (defaults to &lt;tt&gt;&#x27;The minimum length for this field is {minLength}&#x27;&lt;/tt&gt;)
             */
            minLengthText: &#x27;The minimum length for this field is {0}&#x27;,
            /**
             * @cfg {String} maxLengthText Error text to display if the &lt;b&gt;&lt;tt&gt;{@link #maxLength maximum length}&lt;/tt&gt;&lt;/b&gt;
             * validation fails (defaults to &lt;tt&gt;&#x27;The maximum length for this field is {maxLength}&#x27;&lt;/tt&gt;)
             */
            maxLengthText: &#x27;The maximum length for this field is {0}&#x27;,
            /**
             * @cfg {Boolean} selectOnFocus &lt;tt&gt;true&lt;/tt&gt; to automatically select any existing field text when the field
             * receives input focus (defaults to &lt;tt&gt;false&lt;/tt&gt;)
             */
            selectOnFocus: false,
            /**
             * @cfg {String} blankText The error text to display if the &lt;b&gt;&lt;tt&gt;{@link #allowBlank}&lt;/tt&gt;&lt;/b&gt; validation
             * fails (defaults to &lt;tt&gt;&#x27;This field is required&#x27;&lt;/tt&gt;)
             */
            blankText: &#x27;This field is required&#x27;,
            /**
             * @cfg {Function} validator
             * &lt;p&gt;A custom validation function to be called during field validation ({@link #validateValue})
             * (defaults to &lt;tt&gt;null&lt;/tt&gt;). If specified, this function will be called first, allowing the
             * developer to override the default validation process.&lt;/p&gt;
             * &lt;br&gt;&lt;p&gt;This function will be passed the following Parameters:&lt;/p&gt;
             * &lt;div class=&quot;mdetail-params&quot;&gt;&lt;ul&gt;
             * &lt;li&gt;&lt;code&gt;value&lt;/code&gt;: &lt;i&gt;Mixed&lt;/i&gt;
             * &lt;div class=&quot;sub-desc&quot;&gt;The current field value&lt;/div&gt;&lt;/li&gt;
             * &lt;/ul&gt;&lt;/div&gt;
             * &lt;br&gt;&lt;p&gt;This function is to Return:&lt;/p&gt;
             * &lt;div class=&quot;mdetail-params&quot;&gt;&lt;ul&gt;
             * &lt;li&gt;&lt;code&gt;true&lt;/code&gt;: &lt;i&gt;Boolean&lt;/i&gt;
             * &lt;div class=&quot;sub-desc&quot;&gt;&lt;code&gt;true&lt;/code&gt; if the value is valid&lt;/div&gt;&lt;/li&gt;
             * &lt;li&gt;&lt;code&gt;msg&lt;/code&gt;: &lt;i&gt;String&lt;/i&gt;
             * &lt;div class=&quot;sub-desc&quot;&gt;An error message if the value is invalid&lt;/div&gt;&lt;/li&gt;
             * &lt;/ul&gt;&lt;/div&gt;
             */
            validator: null,
            /**
             * @cfg {RegExp} regex A JavaScript RegExp object to be tested against the field value during validation
             * (defaults to &lt;tt&gt;null&lt;/tt&gt;). If the test fails, the field will be marked invalid using
             * &lt;b&gt;&lt;tt&gt;{@link #regexText}&lt;/tt&gt;&lt;/b&gt;.
             */
            regex: null,
            /**
             * @cfg {String} regexText The error text to display if &lt;b&gt;&lt;tt&gt;{@link #regex}&lt;/tt&gt;&lt;/b&gt; is used and the
             * test fails during validation (defaults to &lt;tt&gt;&#x27;&#x27;&lt;/tt&gt;)
             */
            regexText: &#x27;&#x27;

        });

        jprotected({
            initComponent: function () {
                jsuper(this);
            },

            // private
            initEvents: function () {
                jsuper(this);
                if (this.validationEvent == &#x27;keyup&#x27;) {
                    this.validationTask = $.delay(this.validate, this);
                    this.el.on(&#x27;keyup&#x27;, this.filterValidation, this);
                }
                else if (this.validationEvent !== false &amp;&amp; this.validationEvent != &#x27;blur&#x27;) {
                    this.el.on(this.el, this.validationEvent, this.validate, this, {buffer: this.validationDelay});
                }
                if (this.selectOnFocus) {
                    this.el.on(&#x27;mousedown&#x27;, this.onMouseDown, this);
                }
                if (this.maskRe/* || (this.vtype &amp;&amp; this.disableKeyFilter !== true &amp;&amp; (this.maskRe = Ext.form.VTypes[this.vtype + &#x27;Mask&#x27;]))*/) {
                    this.el.on(&#x27;keypress&#x27;, this.filterKeys, this);
                }
                if (this.grow) {
                    //this.mon(this.el, &#x27;keyup&#x27;, this.onKeyUpBuffered, this, {buffer: 50});
                    this.el.on(&#x27;click&#x27;, this.autoSize, this);
                }
                /*if (this.enableKeyEvents) {
                 this.mon(this.el, {
                 scope: this,
                 keyup: this.onKeyUp,
                 keydown: this.onKeyDown,
                 keypress: this.onKeyPress
                 });
                 }*/
            },

            onMouseDown: function (e) {
                /*if (!this.hasFocus) {
                 this.mon(this.el, &#x27;mouseup&#x27;, Ext.emptyFn, this, { single: true, preventDefault: true });
                 }*/
            },
            //private
            onDisable: function () {
                jsuper(this);
            },

            //private
            onEnable: function () {
                jsuper(this);
            },

            // private
            onKeyUpBuffered: function (e) {
                if (this.doAutoSize(e)) {
                    this.autoSize();
                }
            },

            // private
            doAutoSize: function (e) {
                return !e.isNavKeyPress();
            },

            // private
            onKeyUp: function (e) {
                this.fireEvent(&#x27;keyup&#x27;, this, e);
            },

            // private
            onKeyDown: function (e) {
                this.fireEvent(&#x27;keydown&#x27;, this, e);
            },

            // private
            onKeyPress: function (e) {
                this.fireEvent(&#x27;keypress&#x27;, this, e);
            },
            // private
            preFocus: function () {
                var el = this.el;
                if (this.selectOnFocus) {
                    el.dom.select();
                }
            },

            // private
            postBlur: function () {
            },

            // private
            filterKeys: function (e) {
                if (e.ctrlKey) {
                    return;
                }
                var k = e.getKey();
                if (e.isNavKeyPress() || k == e.BACKSPACE || (k == e.DELETE &amp;&amp; e.button == -1)) {
                    return;
                }
                var cc = String.fromCharCode(e.getCharCode());
                /*if (!Ext.isGecko &amp;&amp; e.isSpecialKey() &amp;&amp; !cc) {
                 return;
                 }*/
                if (!this.maskRe.test(cc)) {
                    e.stopEvent();
                }
            },

            onDestroy: function () {
                if (this.validationTask) {
                    this.validationTask.cancel();
                    this.validationTask = null;
                }
                jsuper(this);
            }

        });

        // publc method
        jpublic({
            processValue: function (value) {
                if (this.stripCharsRe) {
                    var newValue = value.replace(this.stripCharsRe, &#x27;&#x27;);
                    if (newValue !== value) {
                        this.setRawValue(newValue);
                        return newValue;
                    }
                }
                return value;
            },

            filterValidation: function (e) {
                if (!e.isNavKeyPress()) {
                    this.validationTask.delay(this.validationDelay);
                }
            },


            /**
             * Resets the current field value to the originally-loaded value and clears any validation messages.
             * original value was blank.
             */
            reset: function () {
                jsuper(this);
            },

            setValue: function (v) {
                jsuper(this);
                this.autoSize();
                return this;
            },
            validateValue: function (value) {
                if ($.isFunction(this.validator)) {
                    var msg = this.validator(value);
                    if (msg !== true) {
                        this.markInvalid(msg);
                        return false;
                    }
                }
                if (value.length &lt; 1) { // if it&#x27;s blank
                    if (this.allowBlank) {
                        this.clearInvalid();
                        return true;
                    } else {
                        this.markInvalid(this.blankText);
                        return false;
                    }
                }
                if (value.length &lt; this.minLength) {
                    this.markInvalid(String.format(this.minLengthText, this.minLength));
                    return false;
                }
                if (value.length &gt; this.maxLength) {
                    this.markInvalid(String.format(this.maxLengthText, this.maxLength));
                    return false;
                }
                /*if (this.vtype) {
                 var vt = Ext.form.VTypes;
                 if (!vt[this.vtype](value, this)) {
                 this.markInvalid(this.vtypeText || vt[this.vtype + &#x27;Text&#x27;]);
                 return false;
                 }
                 }*/
                if (this.regex &amp;&amp; !this.regex.test(value)) {
                    this.markInvalid(this.regexText);
                    return false;
                }
                return true;
            },

            /**
             * Selects text in this field
             * @param {Number} start (optional) The index where the selection should start (defaults to 0)
             * @param {Number} end (optional) The index where the selection should end (defaults to the text length)
             */
            selectText: function (start, end) {
                var v = this.getRawValue();
                var doFocus = false;
                if (v.length &gt; 0) {
                    start = start === undefined ? 0 : start;
                    end = end === undefined ? v.length : end;
                    var d = this.el.dom;
                    if (d.setSelectionRange) {
                        d.setSelectionRange(start, end);
                    } else if (d.createTextRange) {
                        var range = d.createTextRange();
                        range.moveStart(&#x27;character&#x27;, start);
                        range.moveEnd(&#x27;character&#x27;, end - v.length);
                        range.select();
                    }
                    doFocus = true;
                } else {
                    doFocus = true;
                }
                if (doFocus) {
                    this.focus();
                }
            },

            /**
             * Automatically grows the field to accomodate the width of the text up to the maximum field width allowed.
             * This only takes effect if &lt;tt&gt;&lt;b&gt;{@link #grow}&lt;/b&gt; = true&lt;/tt&gt;, and fires the {@link #autosize} event.
             */
            autoSize: function () {
                if (!this.grow || !this.rendered) {
                    return;
                }
                /*if (!this.metrics) {
                 this.metrics = Ext.util.TextMetrics.createInstance(this.el);
                 }*/
                var el = this.el;
                var v = el.dom.value;
                var d = document.createElement(&#x27;div&#x27;);
                d.appendChild(document.createTextNode(v));
                v = d.innerHTML;
                $.remove(d);
                d = null;
                v += &#x27;&amp;#160;&#x27;;
                var w = Math.min(this.growMax, Math.max(this.metrics.getWidth(v) + /* add extra padding */ 10, this.growMin));
                this.el.setWidth(w);
                this.fireEvent(&#x27;autosize&#x27;, this, w);
            }
        });

    }, &#x27;textfield&#x27;);
});
</pre>

</div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/js/tabs.js"></script>
</body>
</html>
